generator client {
    provider      = "prisma-client"
    output        = "../src/generated/client"
    engineType    = "client"
    binaryTargets = ["native"]
    moduleFormat  = "cjs"
}

datasource db {
    provider = "postgresql"
}

model User {
    id        Int       @id @default(autoincrement())
    firstName String
    lastName  String
    email     String    @unique
    weight    Int
    height    Int
    age       Int
    gender    Gender
    role      UserRole?
    tenantId  String?
    Tenant    Tenant?   @relation(fields: [tenantId], references: [id])
    workouts  Workout[] @relation("ClientWorkoutRelation")
    diet      Diet[]    @relation("ClientDietRelation")
    password  String
    createdAt DateTime  @default(now())
}

model Tenant {
    id        String @id @default(cuid())
    name      String
    subdomain String @unique
    users     User[]
}

model Exercise {
    id                String   @id @default(cuid())
    name              String
    sets              Int
    reps              String
    actualPerformance String?
    workout           Workout  @relation(fields: [workoutId], references: [id], onDelete: Cascade)
    workoutId         String
    createdAt         DateTime @default(now())
    updatedAt         DateTime @updatedAt
}

model Meal {
    id          String   @id @default(cuid())
    name        String
    description String
    dietId      String
    cal         Int?
    protein     Int?
    type        MealType
    diet        Diet     @relation(fields: [dietId], references: [id], onDelete: Cascade)
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
}

model Workout {
    id        String     @id @default(cuid())
    name      String
    day       Day
    exercises Exercise[]
    restDay   Boolean    @default(false)
    clientId  Int
    client    User       @relation("ClientWorkoutRelation", fields: [clientId], references: [id], onDelete: Cascade)
    updatedAt DateTime   @default(now()) @updatedAt

    @@unique([day, clientId])
}

model Diet {
    id        String   @id @default(cuid())
    name      String
    day       Day
    meals     Meal[]
    clientId  Int
    client    User     @relation("ClientDietRelation", fields: [clientId], references: [id], onDelete: Cascade)
    updatedAt DateTime @default(now()) @updatedAt

    @@unique([day, clientId])
}

enum Day {
    MONDAY
    TUESDAY
    WEDNESDAY
    THURSDAY
    FRIDAY
    SATURDAY
    SUNDAY
}

enum UserRole {
    ADMIN
    TRAINER
    CLIENT
}

enum MealType {
    BREKFAST
    LUNCH
    DINNER
    SNACK
}

enum Gender {
    MALE
    FEMALE
}
